[2024-03-25T05:35:53.589+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Book-Recommendation-DAG.do_clean_to_parquet_task manual__2024-03-25T05:35:45.516372+00:00 [queued]>
[2024-03-25T05:35:53.599+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Book-Recommendation-DAG.do_clean_to_parquet_task manual__2024-03-25T05:35:45.516372+00:00 [queued]>
[2024-03-25T05:35:53.600+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 3
[2024-03-25T05:35:53.618+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): do_clean_to_parquet_task> on 2024-03-25 05:35:45.516372+00:00
[2024-03-25T05:35:53.623+0000] {standard_task_runner.py:60} INFO - Started process 6882 to run task
[2024-03-25T05:35:53.627+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Book-Recommendation-DAG', 'do_clean_to_parquet_task', 'manual__2024-03-25T05:35:45.516372+00:00', '--job-id', '129', '--raw', '--subdir', 'DAGS_FOLDER/book-recommendation-dag.py', '--cfg-path', '/tmp/tmpp3hig66s']
[2024-03-25T05:35:53.629+0000] {standard_task_runner.py:88} INFO - Job 129: Subtask do_clean_to_parquet_task
[2024-03-25T05:35:53.664+0000] {task_command.py:423} INFO - Running <TaskInstance: Book-Recommendation-DAG.do_clean_to_parquet_task manual__2024-03-25T05:35:45.516372+00:00 [running]> on host 9654d883592e
[2024-03-25T05:35:53.716+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='iamraphson' AIRFLOW_CTX_DAG_ID='Book-Recommendation-DAG' AIRFLOW_CTX_TASK_ID='do_clean_to_parquet_task' AIRFLOW_CTX_EXECUTION_DATE='2024-03-25T05:35:45.516372+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-03-25T05:35:45.516372+00:00'
[2024-03-25T05:35:55.228+0000] {logging_mixin.py:188} INFO - 3                   0          1                 2  ...     6     7     8
435         ivanhoe  melbourne          victoria  ...  None  None  None
814       davis bay    sechelt  british columbia  ...  None  None  None
840   saint charles         mo          missouri  ...  None  None  None
1459       mansoura   dakahlia          mansoura  ...  None  None  None
1520     washington       d.c.                dc  ...  None  None  None

[5 rows x 9 columns]
[2024-03-25T05:35:55.238+0000] {logging_mixin.py:188} INFO - 4                   0       1            2  ...     6     7     8
5641         mexico    city       mexico  ...  None  None  None
6557   schiltigheim  france       alsace  ...  None  None  None
9695         mexico    city       mexico  ...  None  None  None
12512       nanaimo      bc      v9v 1h4  ...  None  None  None
17884        mumbai  mumbai  maharashtra  ...  None  None  None

[5 rows x 9 columns]
[2024-03-25T05:35:55.687+0000] {logging_mixin.py:188} INFO -              0                1               2
0          nyc         new york             usa
1     stockton       california             usa
2       moscow  yukon territory          russia
3        porto         v.n.gaia        portugal
4  farnborough            hants  united kingdom
[2024-03-25T05:35:55.705+0000] {logging_mixin.py:188} INFO - dataset_df.dtypes user_id    Int64
age        Int64
dtype: object
[2024-03-25T05:35:55.705+0000] {logging_mixin.py:188} INFO - parquet_loc /opt/***/book-recommendation-dataset/pq/users.parquet
[2024-03-25T05:35:57.072+0000] {warnings.py:109} WARNING - /opt/***/dags/book-recommendation-dag.py:30: DtypeWarning: Columns (3) have mixed types. Specify dtype option on import or set low_memory=False.
  dataset_df = pd.read_csv(f'{dataset_download_path}{filename}')

[2024-03-25T05:35:57.625+0000] {logging_mixin.py:188} INFO - dataset_df.dtypes isbn                   string[python]
book_title             string[python]
book_author            string[python]
year_of_publication             Int64
publisher              string[python]
dtype: object
[2024-03-25T05:35:57.627+0000] {logging_mixin.py:188} INFO - parquet_loc /opt/***/book-recommendation-dataset/pq/books.parquet
[2024-03-25T05:35:57.682+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-03-25T05:35:57.721+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=Book-Recommendation-DAG, task_id=do_clean_to_parquet_task, execution_date=20240325T053545, start_date=20240325T053553, end_date=20240325T053557
[2024-03-25T05:35:57.806+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-03-25T05:35:57.881+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
