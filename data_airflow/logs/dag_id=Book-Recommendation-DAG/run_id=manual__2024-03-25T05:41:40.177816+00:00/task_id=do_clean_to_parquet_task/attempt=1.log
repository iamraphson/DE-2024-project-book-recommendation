[2024-03-25T05:41:48.743+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Book-Recommendation-DAG.do_clean_to_parquet_task manual__2024-03-25T05:41:40.177816+00:00 [queued]>
[2024-03-25T05:41:48.749+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Book-Recommendation-DAG.do_clean_to_parquet_task manual__2024-03-25T05:41:40.177816+00:00 [queued]>
[2024-03-25T05:41:48.750+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 3
[2024-03-25T05:41:48.758+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): do_clean_to_parquet_task> on 2024-03-25 05:41:40.177816+00:00
[2024-03-25T05:41:48.763+0000] {standard_task_runner.py:60} INFO - Started process 7122 to run task
[2024-03-25T05:41:48.766+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Book-Recommendation-DAG', 'do_clean_to_parquet_task', 'manual__2024-03-25T05:41:40.177816+00:00', '--job-id', '137', '--raw', '--subdir', 'DAGS_FOLDER/book-recommendation-dag.py', '--cfg-path', '/tmp/tmpbjezothm']
[2024-03-25T05:41:48.769+0000] {standard_task_runner.py:88} INFO - Job 137: Subtask do_clean_to_parquet_task
[2024-03-25T05:41:48.806+0000] {task_command.py:423} INFO - Running <TaskInstance: Book-Recommendation-DAG.do_clean_to_parquet_task manual__2024-03-25T05:41:40.177816+00:00 [running]> on host 9654d883592e
[2024-03-25T05:41:48.855+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='iamraphson' AIRFLOW_CTX_DAG_ID='Book-Recommendation-DAG' AIRFLOW_CTX_TASK_ID='do_clean_to_parquet_task' AIRFLOW_CTX_EXECUTION_DATE='2024-03-25T05:41:40.177816+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-03-25T05:41:40.177816+00:00'
[2024-03-25T05:41:50.119+0000] {logging_mixin.py:188} INFO - 3                   0          1                 2  ...     6     7     8
435         ivanhoe  melbourne          victoria  ...  None  None  None
814       davis bay    sechelt  british columbia  ...  None  None  None
840   saint charles         mo          missouri  ...  None  None  None
1459       mansoura   dakahlia          mansoura  ...  None  None  None
1520     washington       d.c.                dc  ...  None  None  None

[5 rows x 9 columns]
[2024-03-25T05:41:50.125+0000] {logging_mixin.py:188} INFO - 4                   0       1            2  ...     6     7     8
5641         mexico    city       mexico  ...  None  None  None
6557   schiltigheim  france       alsace  ...  None  None  None
9695         mexico    city       mexico  ...  None  None  None
12512       nanaimo      bc      v9v 1h4  ...  None  None  None
17884        mumbai  mumbai  maharashtra  ...  None  None  None

[5 rows x 9 columns]
[2024-03-25T05:41:50.131+0000] {logging_mixin.py:188} INFO - 5                                            0  ...      8
76342                            chula vista  ...   None
122814  philippine science high school - cmc  ...   None
194259                              dae-jeon  ...   None
215970                         silver spring  ...   None
241302                                  nmrl  ...  india

[5 rows x 9 columns]
[2024-03-25T05:41:50.137+0000] {logging_mixin.py:188} INFO - 6                     0               1  ...           7      8
194259       dae-jeon        dae-jeon  ...        None   None
215970  silver spring              md  ...        None   None
241302           nmrl  addl-ambernath  ...  maharastra  india

[3 rows x 9 columns]
[2024-03-25T05:41:50.142+0000] {logging_mixin.py:188} INFO - 7            0               1      2  ...      6           7      8
241302  nmrl  addl-ambernath  thane  ...  thane  maharastra  india

[1 rows x 9 columns]
[2024-03-25T05:41:50.149+0000] {logging_mixin.py:188} INFO - 8            0               1      2  ...      6           7      8
241302  nmrl  addl-ambernath  thane  ...  thane  maharastra  india

[1 rows x 9 columns]
[2024-03-25T05:41:50.547+0000] {logging_mixin.py:188} INFO -       0     1     2     3     4     5
0  None  None  None  None  None  None
1  None  None  None  None  None  None
2  None  None  None  None  None  None
3  None  None  None  None  None  None
4  None  None  None  None  None  None
[2024-03-25T05:41:50.562+0000] {logging_mixin.py:188} INFO - dataset_df.dtypes user_id    Int64
age        Int64
dtype: object
[2024-03-25T05:41:50.563+0000] {logging_mixin.py:188} INFO - parquet_loc /opt/***/book-recommendation-dataset/pq/users.parquet
[2024-03-25T05:41:51.744+0000] {warnings.py:109} WARNING - /opt/***/dags/book-recommendation-dag.py:30: DtypeWarning: Columns (3) have mixed types. Specify dtype option on import or set low_memory=False.
  dataset_df = pd.read_csv(f'{dataset_download_path}{filename}')

[2024-03-25T05:41:51.921+0000] {logging_mixin.py:188} INFO - dataset_df.dtypes isbn                   string[python]
book_title             string[python]
book_author            string[python]
year_of_publication             Int64
publisher              string[python]
dtype: object
[2024-03-25T05:41:51.922+0000] {logging_mixin.py:188} INFO - parquet_loc /opt/***/book-recommendation-dataset/pq/books.parquet
[2024-03-25T05:41:51.954+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-03-25T05:41:51.969+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=Book-Recommendation-DAG, task_id=do_clean_to_parquet_task, execution_date=20240325T054140, start_date=20240325T054148, end_date=20240325T054151
[2024-03-25T05:41:52.052+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-03-25T05:41:52.098+0000] {taskinstance.py:3312} INFO - 1 downstream tasks scheduled from follow-on schedule check
